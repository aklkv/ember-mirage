{"version":3,"file":"setup-mirage.js","sources":["../../src/test-support/setup-mirage.js"],"sourcesContent":["import { settled } from '@ember/test-helpers';\n\nimport startMirage from '../start-mirage';\n\n/**\n Used to set up mirage for a test. Must be called after one of the\n `ember-qunit` `setup*Test()` methods. It starts the server and sets\n `this.server` to point to it, and shuts the server down when the test\n finishes.\n\n NOTE: the `hooks = self` is for mocha support\n @hide\n */\nexport function setupMirage(hooks = self, { makeServer, ...options }) {\n  hooks.beforeEach(function () {\n    if (!this.owner) {\n      throw new Error(\n        'You must call one of the ember-qunit setupTest(),' +\n          ' setupRenderingTest() or setupApplicationTest() methods before' +\n          ' calling setupMirage()',\n      );\n    }\n\n    this.server = startMirage(makeServer, { owner: this.owner, ...options });\n  });\n\n  hooks.afterEach(function () {\n    return settled().then(() => {\n      if (this.server) {\n        this.server.shutdown();\n        delete this.server;\n      }\n    });\n  });\n}\n"],"names":["setupMirage","hooks","self","makeServer","options","beforeEach","owner","Error","server","startMirage","afterEach","settled","then","shutdown"],"mappings":";;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO,SAASA,WAAWA,CAACC,KAAK,GAAGC,IAAI,EAAE;EAAEC,UAAU;EAAE,GAAGC,OAAAA;AAAQ,CAAC,EAAE;EACpEH,KAAK,CAACI,UAAU,CAAC,YAAY;AAC3B,IAAA,IAAI,CAAC,IAAI,CAACC,KAAK,EAAE;MACf,MAAM,IAAIC,KAAK,CACb,mDAAmD,GACjD,gEAAgE,GAChE,wBACJ,CAAC,CAAA;AACH,KAAA;AAEA,IAAA,IAAI,CAACC,MAAM,GAAGC,WAAW,CAACN,UAAU,EAAE;MAAEG,KAAK,EAAE,IAAI,CAACA,KAAK;MAAE,GAAGF,OAAAA;AAAQ,KAAC,CAAC,CAAA;AAC1E,GAAC,CAAC,CAAA;EAEFH,KAAK,CAACS,SAAS,CAAC,YAAY;AAC1B,IAAA,OAAOC,OAAO,EAAE,CAACC,IAAI,CAAC,MAAM;MAC1B,IAAI,IAAI,CAACJ,MAAM,EAAE;AACf,QAAA,IAAI,CAACA,MAAM,CAACK,QAAQ,EAAE,CAAA;QACtB,OAAO,IAAI,CAACL,MAAM,CAAA;AACpB,OAAA;AACF,KAAC,CAAC,CAAA;AACJ,GAAC,CAAC,CAAA;AACJ;;;;"}